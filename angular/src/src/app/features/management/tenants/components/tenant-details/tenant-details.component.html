<div class="tenant-details-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="title-section">
      <h1>{{ 'tenantManagement.tenantDetails' | translate }}</h1>
      <p class="subtitle">{{ 'tenantManagement.viewTenantInformationAndStatus' | translate }}</p>
    </div>
    
    <div class="header-actions">
      <p-button 
        [label]="'tenantManagement.backToList' | translate"
        icon="pi pi-arrow-left"
        severity="secondary"
        (onClick)="backToList()">
      </p-button>
      
      <p-button 
        *appHasPermission="['Permission.Tenants.Update']"
        [label]="'tenantManagement.editTenant' | translate"
        icon="pi pi-pencil"
        severity="info"
        (onClick)="editTenant()">
      </p-button>
    </div>
  </div>

  <!-- Messages -->
  <p-message
    *ngFor="let message of messages()"
    [severity]="message.severity"
    [closable]="true"
    (onClose)="messages.set([])">
    {{ message.content | translate }}
  </p-message>

  <!-- Loading State -->
  <div *ngIf="loading()" class="loading-container">
    <div class="skeleton-card">
      <p-skeleton height="2rem" class="mb-2"></p-skeleton>
      <p-skeleton height="1.5rem" class="mb-4"></p-skeleton>
      <p-skeleton height="10rem"></p-skeleton>
    </div>
  </div>

  <!-- Tenant Details -->
  <div *ngIf="!loading() && tenant()" class="details-container">
    <div class="details-grid">
      <!-- Basic Information Card -->
      <div class="detail-card">
        <div class="card-header">
          <h3>{{ 'tenantManagement.basicInformation' | translate }}</h3>
          <p-tag [severity]="getStatusSeverity()">
            {{ getTenantStatusDescription() | translate }}
          </p-tag>
        </div>
        
        <div class="card-content">
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.tenantIdentifier' | translate }}</div>
            <div class="detail-value">{{ tenant()?.identifier }}</div>
          </div>
          
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.tenantName' | translate }}</div>
            <div class="detail-value">{{ tenant()?.name }}</div>
          </div>
          
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.status' | translate }}</div>
            <div class="detail-value">
              <span [class]="isTenantExpired() ? 'text-danger' : ''">
                {{ getTenantStatusDescription() | translate }}
              </span>
            </div>
          </div>
          
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.subscriptionExpiration' | translate }}</div>
            <div class="detail-value">
              <span [class]="isTenantExpired() ? 'text-danger' : ''">
                {{ tenant()?.expirationDate | date:'full' }}
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Administrator Information Card -->
      <div class="detail-card">
        <div class="card-header">
          <h3>{{ 'tenantManagement.administratorInformation' | translate }}</h3>
        </div>
        
        <div class="card-content">
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.adminName' | translate }}</div>
            <div class="detail-value">{{ getTenantAdminFullName() }}</div>
          </div>
          
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.adminEmail' | translate }}</div>
            <div class="detail-value">
              <a [href]="'mailto:' + tenant()?.email">{{ tenant()?.email }}</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Database Information Card -->
      <div class="detail-card" *ngIf="tenant()?.connectionString">
        <div class="card-header">
          <h3>{{ 'tenantManagement.databaseInformation' | translate }}</h3>
        </div>
        
        <div class="card-content">
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.connectionType' | translate }}</div>
            <div class="detail-value">
               <p-tag severity="info">
                 {{ 'tenantManagement.connectionTypes.isolated' | translate }}
               </p-tag>
            </div>
          </div>
          
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.databaseDescription' | translate }}</div>
            <div class="detail-value">
              {{ 'tenantManagement.isolatedDatabaseDescription' | translate }}
            </div>
          </div>
          
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.connectionString' | translate }}</div>
            <div class="detail-value">
              <div class="connection-string-container">
                <code class="connection-string">{{ tenant()?.connectionString }}</code>
                <button 
                  type="button" 
                  class="btn btn-sm btn-outline-secondary copy-btn"
                  (click)="copyConnectionString()"
                  [title]="'tenantManagement.copyConnectionString' | translate">
                  <i class="pi pi-copy"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Database Information Card (Shared) -->
      <div class="detail-card" *ngIf="!tenant()?.connectionString">
        <div class="card-header">
          <h3>{{ 'tenantManagement.databaseInformation' | translate }}</h3>
        </div>
        
        <div class="card-content">
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.connectionType' | translate }}</div>
            <div class="detail-value">
               <p-tag severity="success">
                 {{ 'tenantManagement.connectionTypes.shared' | translate }}
               </p-tag>
            </div>
          </div>
          
          <div class="detail-row">
            <div class="detail-label">{{ 'tenantManagement.databaseDescription' | translate }}</div>
            <div class="detail-value">
              {{ 'tenantManagement.sharedDatabaseDescription' | translate }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons" *appHasPermission="['Permission.Tenants.Update']">
      <p-button 
        *ngIf="!tenant()?.isActive"
        [label]="'tenantManagement.activateTenant' | translate"
        icon="pi pi-check"
        severity="success"
        (onClick)="activateTenant()">
      </p-button>
      
      <p-button 
        *ngIf="tenant()?.isActive"
        [label]="'tenantManagement.deactivateTenant' | translate"
        icon="pi pi-times"
        severity="danger"
        (onClick)="deactivateTenant()">
      </p-button>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="!loading() && !tenant()" class="error-container">
    <div class="error-state">
      <i class="pi pi-exclamation-triangle" style="font-size: 4rem; color: #dc3545;"></i>
      <h3>{{ 'tenantManagement.tenantNotFound' | translate }}</h3>
      <p>{{ 'tenantManagement.tenantNotFoundMessage' | translate }}</p>
      <p-button 
        [label]="'tenantManagement.backToList' | translate"
        icon="pi pi-arrow-left"
        severity="info"
        (onClick)="backToList()">
      </p-button>
    </div>
  </div>
</div>
