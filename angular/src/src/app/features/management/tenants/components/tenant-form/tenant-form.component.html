<div class="tenant-form-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="title-section">
      <h1>{{ (isEditMode() ? 'tenantManagement.editTenant' : 'tenantManagement.createTenant') | translate }}</h1>
      <p class="subtitle">{{ (isEditMode() ? 'tenantManagement.editTenantOrganization' : 'tenantManagement.createNewTenantOrganization') | translate }}</p>
    </div>
    
    <p-button
      type="button"
      [label]="'tenantManagement.backToList' | translate"
      icon="pi pi-arrow-left"
      severity="secondary"
      (onClick)="onCancel()">
    </p-button>
  </div>


  <!-- Loading State -->
  <div *ngIf="loading() && isEditMode()" class="loading-container">
    <div class="loading-content">
      <i class="pi pi-spin pi-spinner"></i>
      <p>{{ 'tenantManagement.loadingTenantData' | translate }}</p>
    </div>
  </div>

  <!-- Form -->
  <div class="form-container" *ngIf="!loading() || !isEditMode()">
    <form [formGroup]="tenantForm" (ngSubmit)="onSubmit()">
      <div class="form-row">
        <!-- Tenant Name -->
        <div class="form-group">
          <label for="name" class="p-label">
            {{ 'tenantManagement.tenantName' | translate }} *
          </label>
          <input
            type="text"
            id="name"
            pInputText
            formControlName="name"
            placeholder="Digite o nome da empresa"
            [class.p-invalid]="isFieldInvalid('name')">
          <div *ngIf="isFieldInvalid('name')" class="p-error mt-1">
            {{ getFieldError('name') }}
          </div>
        </div>
      </div>

      <div class="form-row">
        <!-- Admin First Name -->
        <div class="form-group">
          <label for="firstName" class="p-label">
            {{ 'tenantManagement.adminFirstName' | translate }} *
          </label>
          <input
            type="text"
            id="firstName"
            pInputText
            formControlName="firstName"
            placeholder="Digite o nome do administrador da empresa"
            [class.p-invalid]="isFieldInvalid('firstName')">
          <div *ngIf="isFieldInvalid('firstName')" class="p-error mt-1">
            {{ getFieldError('firstName') }}
          </div>
        </div>

        <!-- Admin Last Name -->
        <div class="form-group">
          <label for="lastName" class="p-label">
            {{ 'tenantManagement.adminLastName' | translate }} *
          </label>
          <input
            type="text"
            id="lastName"
            pInputText
            formControlName="lastName"
            placeholder="Digite o sobrenome do administrador da empresa"
            [class.p-invalid]="isFieldInvalid('lastName')">
          <div *ngIf="isFieldInvalid('lastName')" class="p-error mt-1">
            {{ getFieldError('lastName') }}
          </div>
        </div>
      </div>

      <div class="form-row">
        <!-- Admin Email -->
        <div class="form-group">
          <label for="email" class="p-label">
            {{ 'tenantManagement.adminEmail' | translate }} *
          </label>
          <input
            type="email"
            id="email"
            pInputText
            formControlName="email"
            placeholder="Digite o email do administrador da empresa"
            [class.p-invalid]="isFieldInvalid('email')">
          <div *ngIf="isFieldInvalid('email')" class="p-error mt-1">
            {{ getFieldError('email') }}
          </div>
          <small class="p-text-secondary mt-1">
            {{ 'tenantManagement.adminEmailHelpText' | translate }}
          </small>
        </div>

        <!-- Expiration Date -->
        <div class="form-group">
          <label for="expirationDate" class="p-label">
            {{ 'tenantManagement.subscriptionExpiration' | translate }} *
          </label>
          <p-datepicker
            id="expirationDate"
            formControlName="expirationDate"
            [showIcon]="true"
            [minDate]="minDate"
            dateFormat="dd/mm/yy"
            placeholder="Selecione a data de expiração"
            [class.p-invalid]="isFieldInvalid('expirationDate')">
          </p-datepicker>
          <div *ngIf="isFieldInvalid('expirationDate')" class="p-error mt-1">
            {{ getFieldError('expirationDate') }}
          </div>
        </div>
      </div>

      <div class="form-row">
        <!-- Connection String -->
        <div class="form-group full-width">
          <label for="connectionString" class="p-label">
            {{ 'tenantManagement.databaseConnectionString' | translate }}
          </label>
          <textarea
            id="connectionString"
            pInputTextarea
            formControlName="connectionString"
            placeholder="Digite a string de conexão do banco de dados (opcional)"
            rows="3">
          </textarea>
          <small class="p-text-secondary mt-1">
            {{ 'tenantManagement.connectionStringHelpText' | translate }}
          </small>
        </div>
      </div>

      <div class="form-row">
        <!-- Active Status -->
        <div class="form-group">
          <div class="flex align-items-center gap-2">
            <p-checkbox
              id="isActive"
              formControlName="isActive"
              [binary]="true">
            </p-checkbox>
            <label for="isActive" class="cursor-pointer">
              {{ 'tenantManagement.activateTenantImmediately' | translate }}
            </label>
          </div>
          <small class="p-text-secondary mt-1">
            {{ 'tenantManagement.activateTenantHelpText' | translate }}
          </small>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <p-button
          type="button"
          label="{{ 'tenantManagement.cancel' | translate }}"
          icon="pi pi-times"
          severity="secondary"
          (onClick)="onCancel()">
        </p-button>
        
        <p-button
          type="submit"
          [label]="loading() ? 
            (isEditMode() ? ('tenantManagement.updating' | translate) : ('tenantManagement.creating' | translate)) : 
            (isEditMode() ? ('tenantManagement.updateTenant' | translate) : ('tenantManagement.createTenant' | translate))"
          [icon]="loading() ? 'pi pi-spin pi-spinner' : 'pi pi-check'"
          [disabled]="loading() || !tenantForm.valid">
        </p-button>
      </div>
    </form>
  </div>
</div>
